---
cover: assets/img/covers/being_on-call.png
description: A summary of the expectations and responsibilities of being on-call at PagerDuty, along with some best practice and etiquette recommendations.
---
![Alert Fatigue](../assets/img/headers/alert_fatigue.png)

オンコールに期待することと役立つ情報のまとめ。

## オンコール (On-call) とは？

オンコールとは、あなたが担当するシステムで発生する問題解決の問題の調査、解決をするために、いつでも連絡を取れることを意味します。
例えばPagerDutyのオンコールでは、サービスによってアラームがトリガーされ、何が起こっているか、どのように修正するかの「警告 (page) 」を受け取ります（モバイルデバイス、Eメール、電話、SMSなどを使ったアラート）。
問題を解決して、サービスを元の状態に戻すために必要なアクションを求められます。

## 責務

1. **準備**
    * ラップトップとインターネット回線の準備（会社、家、MiFiドングル、デザリングできる携帯電話、など）
    * アラートのエスカレーションは5分ごとに発生し、それぞれが設定されている（プッシュ、SMSなど、電話）
        * PagerDutyのテキストと呼び出しが、[おやすみモード (Do Not Disturb) を回避](https://support.pagerduty.com/docs/notification-phone-numbers) することを確認してください。
    * 準備が整っている事 （環境が整い、必要なレポジトリが手元にコピーされて動作する、ワークステーションの設定がされテストができている、サードパーティーのクレデンシャルが細心である、など）
    * 我々のIncident Response （このドキュメント）をよ読み、重大なインシデントへの対応やコミュニケーション方法やそれぞれのロールなどを、理解している。
    * 休暇、旅行、約束の予定と、オンコールの日程（プライマリ、バックアップ）が調整できている。

1. **トリアージ**
    * 可能ならアラートを意識して行動する（下記の「責務ではない」を参照）
    * 問題の緊急性を判断する
        * すぐに対応する必要があるのか、重大インシデントにエスカレーションする必要があるのか（本番サーバーが炎上している状況、セキュリティアラート）
        * 夜間に行う必要が無いようなものか（例えばディスク使用量が一定水準を超えたが、まだ空き容量があり、差し迫った状況になる傾向ではない）。
          適切な時間（勤務時間、次の朝、など）までアラートを無効化しておき、その時にたいおうします。
    * Slackで現在のアクティビティを確認します。
      しばしば（いつもではない）アラートが発生する可能性のある行動が告知されています。
    * アラートと初期調査は一般的な問題なのか、関連するチームが見るべき特定のサービスなのか。
      自分の専門でないようなら、他のチームにエスカレーションしましょう。
1. **修正**
    * あなたには問題に飛び込み修正する権限があります。
    * 必要に応じて他チームのメンバーも巻き込みいましょう。
      通常の時間で問題が解決しない場合や、対応したことが無いサービスやアラートの場合に、エスカレーションすることをためらわないでください。
    * 問題の緊急性が低くて、他の優先的なタスクがある場合は、JIRAチケットを（適切な優先度で）作成して後で対応できるようにします。
1. **改善**
    * 特定の問題が継続する場合。アラートが成り続けるが対応できる問題ではない場合、おそらく改善するには時間がかかるでしょう。
        * ディスクがいっぱいになったり、ログのローテートが必要だったり、アラートがうるさかったり、など
    * もし原因を見つけるのが難しい場合は、それを書き留めてください。
      知見をとドキュメントを、常にリファクタリングしてかいぜんするのです。
      もしwikiやコードベースのイメージが整理されてない場合は、冗長なリンクやポインタを追加してください。
1. **サポート**
    * オンコールの "シフト" が終わったとき、次のオンコールに未解決の問題と、注意すべき点を伝えます。
    * スケジュールの変更がある場合（例えば追加や削除）、前もってオンコールのスケジュールを組むために、他のメンバーに伝えてください。
    * 互いにサポートしてください。大量の計画が発生する可能性がある場合は、オンコールの人に知らせて新たなスケジュールを組み、警告を奪うのが礼儀です。

## 責務ではない

1. オンコール期間中は、必ずしも最初のアラートで応答する必要はありません。
    * 通勤（および他の休憩）は生活に必要で、スカレーション前にアラートに応答できないこともあります。
      これがオンコールのバックアップとスケジュールです。
1. 全ての問題を解決できる必要はありません。
    * 誰もが全知全能ではありません。
      チーム全員がサポートします。
      確信がない問題をエスカレーションしても、恥じることではありませんし、学ぶこともあります。
      我々のモットーは「エスカレーションをためらわない」です。
    * サービスの所有者は、サービスがどのように機能するかを知っています。
      特にドキュメントが少ない場合、ミスを防ぐために関連するチームでダブルチェックします。
      念には念を、専門家に確認することが良いです。

## 推奨事項

もしチームが独自のオンコールローテーションを組んでいるばいい、運用チームが推奨するスケジューリングをいくつか紹介します。

* 常にバックアップを用意する。これは同じオンコール枠に2人を用意するということです。
  連絡の取れるメンバーが待機していると、主対応するひとのストレスを軽減できます。
    * バックアップシフトは、通常主対応のシフト後にすることがおおいです。
      前回の主対応が追加の文脈を引き継ぐ事ができるためです。
      また前の対応した人が、次のシフトに問題を修正させようと問題を放置するのを防ぐためでもあります。

* エスカレーションの第3段階（バックアップスケジュールのあと）は、チーム全体です。
  これは置きないことを祈りますが（運用チームで1度起こりました）、これは次に対応できる人を見つけるのが簡単です。

![Escalation](../assets/img/misc/escalation.png)

* チームのマネージャーも通常のローテーションに組めます（組むべきです）。
  実際何が起こっているかを理解できます。

* 新しいチームメンバーは、最初の数週間はオンコールのローテーションを追従すべきです。
  新しいチームメンバーは、全てのアラートを受けて、チームが何をしているかを追う必要があります
  （全ての新入社員は、1週間のオンコールを追従します。これは新しいチームメンバーがチームのローテーションに追従するのにも役に立ちます。）

* エスカレーションのタイムアウトは5分に設定スるることをお勧めします。
  この時間はインシデントに応答できる、十分な時間である必要があります。
  5分以内に応答できない場合は、インシデント対応するとに適した環境でない可能性があります。

* オンコールから外れるときは、シフトで発生しうる問題を、次のオンコール当番に簡単に説明する必要があります。
  サービスがバタバタしている (flapped) 場合や、問題が再発しやすい場合などです。
  きちんと伝えたいのならEメールでも良いですが、口頭での報告でも十分です。

### 推奨する通知方法

インシデントに対応できるのなら、好きな方法で通知を受け取っても構いません。
もしそれがわからない場合は、運用チームはいくつかの推奨する方法があります。

![Mobile Alerts](../assets/img/misc/mobile_alerts.png)

* まずプッシュ通知とEメールで通知します。
  ほとんどは常に携帯電話を持っているので、これは十分によい方法です。
* その後は毎分、携帯、あるいはSMSから通知します。
  通知がうまく届かない場合、電話をかけるなどの強力な方法で連絡します。
  手遅れになるまでに、毎分電話をします。
  3回目までに電話に出ない場合は対応できない可能性が高く、別の人にエスカレーションされます。

## エチケット

* もし現在のオンコール当番が、疲れた顔をして昼の12時にオフィスに来ても、それは怠惰だからではありません。
  おそらく夜に呼び出されたためです。
  ゆっくりさせてください。
* 他の人が対応中のインシデントに応答しないでください。
  インシデントで呼び出されていない場合は、それに応答してはいけません。
  代わりにメモをコメントに書き残してください。

![Acknowledging](../assets/img/misc/ack.png)

* もしテストなどで警告が発生しそうな場合は、その時間は「警告を取得」してください。
  オンコール当番の人に、これから1時間警告を取得すると伝えてください。

* エスカレーションを躊躇しない。
  問題の解決方法がわからないときは、他人に相談することを恥ずかしく思わないでください。
  同様に、もし他の人に頼られても、決して他人を見下してはいけません。

* 他のメンバーがオンコールを交代したいと言っているとき、常に代行を考えてください。
  私達はいつでもオンコールに出られない事があるかも知れません。
  たとえばあなたが町の外からの友達と夜を過ごす時に、オンコールを交代してもらうこともあります。

* オンコールシフト中に警告が鳴ると、その問題を解決する責任があります。
  たとえ3時間かかってシフトが残り1時間であったとしてもです。
  次のオンコールに引き継ぐこともできますが、いつも可能だとは限りません。
